---
title: "Hh 08 Week01 Remind"
date: "2025-03-29"
draft: true
tags: ["항해99 플러스백엔드 8기"]
---

# 멘토링하면서 깨달은 점

- 통합테스트/유닛테스트 의 범위는 정해져있지 않다.
- DTO입장에서는 서비스 메서드함수 한개가 통합테스트가 될 수도 있다.
- 단위테스트는 테스트 대상외의것들을 (서비스의 의존성을 비롯한 테스트 대상에는 해당되지않지만 서비스에 연결되어있는 대상들을) Mocking 을 해야한다.
- 객체에게는 책임이 있다.

---

- 잠금의범위: synchronized: 현재 인스턴스의 전체 스레드 레벨에서 막는다. 한번에 한명밖에 실행못함.
- 우리가 동시성 제어를 하고 싶었던 것
  - 준규 -> 준규 충전하려고할때 둘다 반영
  - 준규 -> 은강 -> 형재 -> 유진 -> 찬희 -> 민수 6명이 각각 자기돈을 충전하려고 동시에 시도하는 것
    - 서로다른 자원에 접근하지만 각각 기다려야됨.
- thread-safe

- 통합테스트를 할지말지 '최소기준'
    - 내가 호출할 친구가 통합테스트로 검증되었느냐 안되었느냐 
    -  내가 호출할 친구가 통합테스트로 검증되었는데...
- e2e관점에서 QA의 입장, 개발자가 아닌사람이라면 내부는 궁금하지않고 결과만을 호출할수도있음.(통합테스트)
- 돈 충전에 대한 단위테스트: UserPoint
    - 돈충전에 대해서 테스트하고싶다면 그 돈충전과 관련된 로직외 나머지 외부는 모킹을 해야되는것.
- 돈 충전에 대한 통합테스트: PointService
    - 실제로 돈충전일어나려면 유저포인트(어디선가에서 가져와야하는 대상) 그후 연산결과를 저장해서 유지되는거 확인이 되고나서 서비스를 테스트

- 충전함수 -> 서비스에서 충전관련 테스트를 한다면, 실제 저장되었는지 통합테스트

```java
class UserService {
    private UserPoint userPoint;

    // 충전함수 -> 서비스 에서 충전관련 테스트를 한다면 실제로 저장됐는지 통합테스트
    
    @Test
    void 유저_생성시_포인트가_양수라면_정상적으로_생성된다() {
        // arrange
        // act
        // 낙관적 정상생성 - 테스트 실패안하니까 잘되겠지... (안해도됨)
        UserPoint userPoint
        // 비관적 정상생성 - 누구도 믿을 수 없음...
        User
        // assert
        assertThat(userPoint.userId()).isEqualTo(userId);
        assertThat(userPoint.amount()).isEqualTo(amount);
    }

    돈충저
}
```
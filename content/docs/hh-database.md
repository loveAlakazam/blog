---
title: "데이터베이스 처리"
date: "2025-04-12"
draft: true
---

정규화와 비정규화

읽기성능과 쓰기성능은 서로 트레이드오프관계

가상테이블? 메터럴라이즈뷰 패턴.

인덱스?

MVCC?

InnoDB

데이터베이스의 기본 격리레벨은 3이다.

리피터블 리드

커밋티드 리드

디비 인덱스 와 쿼리최적화(쿼리튜닝)

전체를 풀스캔하지 않게끔하다. -> 인덱스 테이블

항상 풀스캔을 고려

인덱스의 목적은 검색이다.
쓰기성능이 왜 안좋아져서? 데이터 삽입/삭제할때 변경을 해줘야한다.
한테이블에 인덱스가 8개 이상이면 설계를 잘못하는편이고 5개정도 유지하는 편이다.
복합인덱스로 갈필요는 없다. 복합인덱스가 단위인덱스보다 성능이 좋다.

카디널리티

주민등록번호 카디널리티가 높다
카디널리티가 높은 값을 인덱스로잡아도 디비 인덱스는 풀스캔하게된다
인덱스가 걸려도 새로 최적화를 한다

데이터의 성향이 바뀌게되면 인덱스를 안탈수있다.
카디널리티가 높다 적다는 우리가 생각으로만했다... 실제로 높다 낮다 구분이 필요하다.
데이터베이스는 최적화에 대해서 공부를 하는게 좋다

복합인덱스는 두개이상을 인덱스로 걸어버린다.
카디널리티가 높은거에서 낮은걸로 거는게 성능상 괜찮다
mysql8.0 인덱스에서 단일인덱스를 활용해서 복합인덱스처럼 유사한 인덱스
복합인덱스가 더 빠르다... 튜닝이 되니까?

테이블 엑세스없이 인덱스높은거..스캔
PK하나로만 조회하면 커버링 인덱스이다.
where절에 인덱스를 타지만, pk를 조회하지 않으면 커버링 인덱스 효과가 없다?

인덱스컬럼의 기준은 높은 카디널리티이다.
카디널리티가 낮으면 디비를 풀스캔하게된다.
enum에 인덱스를 거는것? => 성능이 안나온다...

카디널리티가 높은 순으로 배치한다
복합인덱스는 카디널리티가 낮은걸로 튜닝할수잇다

인덱스 컬럼값과 타입을 사용
컬럼값을 그대로 사용 -> 막 내가 조작해서 사용하는건 좋지 않음
like, between.. 찾아보기
admin개발을 mysql로 하다가
비교연산자도 쓰면 안된다.
본인만의 블로그에 인덱스가 적용되는것과 안되는것을 잘 정리하는게 좋다.

or보다는 union을 하는게 성능이 높아진다.
인덱스는 read연산의 효율을 높이지만 cud연산에서 오버헤드 발생

동시성 스케줄러
통계를 활용하는 방법
배치 프로세스
비정규화...현상..

많은 테이블을 설계해봐야한다.
실생활에 접한걸 데이터로 어떻게 표현할지?
게임을하면 마비노기를 어떻게 표현? 어떤 클래스로 나타내기?

테이블과 클래스다이어그램으로 설계를 했으면 좋겠다
트랜잭션과 인덱스는 꼭 적용을 해야한다

infra-structure 레이어 작성 -> 기능별 통합테스트 작성
디비는 mysql기반으로 작성
step08 조회가 오래걸릴수있는 기능을 리스트업, 테이블 재설계 인덱스등 솔루션 도출
보고서 작성능력이 중요하다
ADR이라고 생각하고, 기술선택사항에대해서 결정을하는거니까 기능을 리스트업하고 이러한 작업을 왜하는지 배경설명이 있어야한다 이문제를 어떻게 해결해야되는지 설득하는 문서를 작성.

느린상태다 그이유와 원인분석과 해결하기 위한 방법들을 보고서
주요기능별 동시성테스트를 작성
동시성문제를 해결.하려면 락을 걸어야되는데
동시성하면서 실패를 하게될텐데 그 실패를 나오게... 다음주에 락을 처리해야함
실패테스트를 만드는 것을 해주세요.

보고서 작성하고 PR하는게 점점 중요해진다.

래포지토리 테스트는 통합테스트(영속화) 하드웨어 통신을 봐야된다
도메인은 영속화가 잘됐는지는 관심이 없다 레포지토리 인터페이스를 DIP를 했는데

레포지토리는 통합테스트일수밖에 없다.

이작업 왜 하고
어떤게 문제고
어떤걸 해결하려고하고
어떤걸로 해결을했고
목적이 분명한 글쓰기
글을 잘쓰고 글에 대한 이해를 높이는데 선택한다
글쓰기 이해를 할수있는 연습을 해야한다.
큰도움이된다

해시맵, 하나더 깊은데.
N+1 문제
표면적인거보다...깊이
테스트 컨테이너 추천.
실무에서 fk건다 안건다? => 안건다
데드락이 발생할 수있다... 데드락이 걸린다
fk데드락 키워드 검색해보기

어드민을 통한 삽입/업데이트 가 없는 상황...
데이터 삭제할때 문제가 많음...
fk를 걸지않는다
영한님도 안건다...

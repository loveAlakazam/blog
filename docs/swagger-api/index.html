<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?) | EK Dev Blog</title>
<meta name=keywords content><meta name=description content="서론 API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다. 백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다. 이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.
스프링부트에 스웨거 도입하기 Java: 17 SpringBoot: 3.4.4 build.gradle 에 추가하기 1 2 3 4 5 6 7 dependencies { // Swagger UI implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2' ...생략... } application.yaml 에 추가하기 1 2 3 4 5 6 7 8 9 10 11 spring: application: name: hhplus-concert ."><meta name=author content><link rel=canonical href=https://loveAlakazam.github.io/blog/docs/swagger-api/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://loveAlakazam.github.io/blog/docs/swagger-api/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://loveAlakazam.github.io/blog/docs/swagger-api/"><meta property="og:site_name" content="EK Dev Blog"><meta property="og:title" content="SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)"><meta property="og:description" content="서론 API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다. 백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다. 이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.
스프링부트에 스웨거 도입하기 Java: 17 SpringBoot: 3.4.4 build.gradle 에 추가하기 1 2 3 4 5 6 7 dependencies { // Swagger UI implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2' ...생략... } application.yaml 에 추가하기 1 2 3 4 5 6 7 8 9 10 11 spring: application: name: hhplus-concert ."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-04T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)"><meta name=twitter:description content="서론 API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다. 백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다. 이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.
스프링부트에 스웨거 도입하기 Java: 17 SpringBoot: 3.4.4 build.gradle 에 추가하기 1 2 3 4 5 6 7 dependencies { // Swagger UI implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2' ...생략... } application.yaml 에 추가하기 1 2 3 4 5 6 7 8 9 10 11 spring: application: name: hhplus-concert ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"https://loveAlakazam.github.io/blog/docs/"},{"@type":"ListItem","position":2,"name":"SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)","item":"https://loveAlakazam.github.io/blog/docs/swagger-api/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)","name":"SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)","description":"서론 API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다. 백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다. 이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.\n스프링부트에 스웨거 도입하기 Java: 17 SpringBoot: 3.4.4 build.gradle 에 추가하기 1 2 3 4 5 6 7 dependencies { // Swagger UI implementation \u0026#39;org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2\u0026#39; ...생략... } application.yaml 에 추가하기 1 2 3 4 5 6 7 8 9 10 11 spring: application: name: hhplus-concert .","keywords":[],"articleBody":"서론 API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다. 백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다. 이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.\n스프링부트에 스웨거 도입하기 Java: 17 SpringBoot: 3.4.4 build.gradle 에 추가하기 1 2 3 4 5 6 7 dependencies { // Swagger UI implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2' ...생략... } application.yaml 에 추가하기 1 2 3 4 5 6 7 8 9 10 11 spring: application: name: hhplus-concert ...(생략) springdoc: api-docs: path: /v3/api-docs swagger-ui: path: /swagger-ui.html operationSorter: method 도입중 문제 발생 로컬호스트에서 실행후, 브라우저의 URL에 localhost:8080/swagger-ui/index.html 에 접속했더니 아래이미지와 같은 에러가 발생했습니다.\n이 에러에 대한 문제점 원인은 GlobalHandlerException 핸들러의 @RestControllerAdvice 데코레이터를 붙였기 때문에 발생했습니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // GlobalExceptionHandler.java @RestControllerAdvice public class GlobalExceptionHandler { // 유효성검사 실패로 발생한 예외처리: 400 에러반환 @ExceptionHandler(InvalidValidationException.class) @ResponseStatus(HttpStatus.BAD_REQUEST) public ErrorResponse handleInvalidValidationException(InvalidValidationException e) { return ErrorResponse.of(HttpStatus.BAD_REQUEST.value(), e.getMessage()); } // 서버내부 오류로 발생한 예외처리: 500 에러반환 @ExceptionHandler(Exception.class) @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR) public ErrorResponse handleException(Exception e) { return ErrorResponse.of(HttpStatus.INTERNAL_SERVER_ERROR.value(), e.getMessage()); } } 실행로그에서 발생한 오류문구는 아래와 같이 기재되어있습니다. 이 에러에 대한 해석을 해보자면, “현재 실행중인 코드가 ControllerAdviceBean(Object) 라는 생성자 메서드가 있는줄 알았는데 실제로는 그 메서드가 없는 Spring 라이브러리를 참조하고 있어서 발생하는 오류이기 때문입니다.\njava.lang.NoSuchMethodError: ‘void org.springframework.web.method.ControllerAdviceBean.(java.lang.Object)’\nSwagger UI는 내부적으로 [GET] /v3/api-docs URL을 호출하는데 이 요청을 처리하는 과정에서 @ControllerAdvice를 스캔하거나 초기화할때 오류가 발생하여 서버 자체에서 500에러를 리턴하여 스웨거문서 로딩에 실패됩니다.\nGlobalExceptionHandler에 부여된 @RestControllerAdvice 데코레이터를 제거함으로써 이 문제를 해결했습니다.\n참고: [트러블슈팅] Swagger 500에러: Failed to load API definition 로컬호스트에 있는 swagger API명세를 swaggerHub에 옮길 수 없을까? 1. 로컬호스트의 swagger(localhost:8080/swagger-ui/index.html)에 접속하기 2. /v3/api-docs에 접속해서 json코드를 얻기 위의 이미지처럼 작은 글씨로 /v3/api-docs 링크에 들어가게되면 로컬에 띄운 swaggerUI에 대한 JSON 파일을 얻을 수 있습니다. 참고로 pretty 포맷팅보다는 raw 포맷팅으로 json파일을 복사하기를 권장합니다.\n3. 코드 포맷 변경 사이트에 들어가서 json 복붙하여 yaml 로 코드를 변환하기 코드 포맷 변경 사이트: BairesDev 4. 만들어둔 SwaggerHub 프로젝트에 복붙후 이상없으면 저장하기 SwaggerHub 프로젝트는 SmartBear의 SwaggerHub에 회원가입 후에 프로젝트를 만들 수 있습니다. 신규계정은 30일동안 유료티어 기능을 사용할 수 있어요~!\n참고: Github에 Swagger API 문서를 공유하기 github-action을 이용해서 swagger 서버를 배포해보자 직접 localhost에 있는 스웨거 json코드를 yaml로 변환해서 swaggerHub에 직접 복붙하는 방식은 손이 많이 가기때문에 귀찮고 불편했습니다. API 응답결과나 응답상태값이 추가되거나 변경될 수 있을텐데 유지보수 측면에서는 비효율을 해결하고 싶었습니다.\n여러가지 방법들이 존재 했습니다. github-action이 가장쉬운방법이긴한데.. 아쉽게도 github-pages를 이용한 방법을하려면 깃헙계정 1개당 1개의 페이지를 만들 수 있는 제약이 있습니다. 저의 경우에는 이 블로그가 github-page를 이용한 방법이기때문에 다른 방법을 찾아봐야했습니다. 고민하던중 깃헙액션의 워크플로우로 작성하는 방법으로 진행해보기로했습니다.\n워크플로우 파일 작성 (1차) deploy-openapi-swaggerhub.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 name: Deploy OpenAPI Spec to SwaggerHub on: push: branches: [\"main\"] jobs: deploy-openapi: runs-on: ubuntu-latest env: OWNER: sampleswagger-f17 API_NAME: hh-08-concert VERSION: 1.0.0 steps: - name: Checkout uses: actions/checkout@v3 - name: Give execute permission to gradlew run: chmod +x ./gradlew # application 빌드 - name: Build the application run: ./gradlew bootJar # application 백그라운드에서 실행 - name: Run the application in background run: | java -jar build/libs/concert-0.0.1-SNAPSHOT.jar \u0026 echo $! \u003e pid.txt # 스프링부트가 완전히 올라올때까지 대기 # # http://localhost:8080/actuator/health 는 health-check이며 # 서버가 잘 동작하는지 확인할 수 있습니다. - name: Wait for server to be ready run: | for i in {1..30}; do curl --silent http://localhost:8080/actuator/health \u0026\u0026 exit 0 echo \"⏳ Waiting for server ...\" sleep 2 done echo \"❌ Server did not start in time\" cat pid.txt | xargs kill exit 1 # 로컬호스트내 OpenAPI 스펙다운로드 - name: Download OpenAPI spec run: curl http://localhost:8080/v3/api-docs -o openapi.json - name: Install SwaggerHub CLI run: npm install -g swaggerhub-cli - name: Push to swaggerHub run: | swaggerhub api:push // \\ --file openapi.json \\ --token ${{ secrets.SWAGGERHUB_API_KEY }} \\ --visibility public swaggerHub의 정보 파악하기 스웨거헙은 OWNER / API_NAME / VERSION 으로 구성되어있습니다. 아래의 이미지의 URL을 확인해보시면 쉽게 이해할 수 있습니다.\n스웨거 API키 발급과 깃헙시크릿키 값에 넣기 swaggerHub의 API 시크릿키 찾기\nswaggerHub API 시크릿값을 Github 래포지토리 시크릿값에 넣기\n반복되는 빌드 실패… 결국은 워크플로우를 했지만 실패가 나왔습니다. 그에대한 이유는 아무래도 스프링부트를 실행하려면 데이터베이스와의 연결이 필요하기 때문입니다. 이 프로세스가 되려면 원격으로 데이터베이스가 필요합니다. 하지만 스웨거만을 배포해야되므로 굳이 클라우드의 DB를 붙일 필요가 없으므로 TestContainers를 하기로 했습니다.\nTestContainer 설정하기 이 프로젝트에서는 Mysql을 사용하기 때문에 TestContainer도 동일한 데이터베이스를 사용해야합니다. build.gradle에 TestContainer 관련해서 추가해야합니다.\n1 2 3 4 5 6 // build.gradle dependencies { testImplementation 'org.testcontainers:junit-jupiter' testImplementation 'org.testcontainers:mysql' } 워크플로우파일 작성 (2차) application-ci.yml\n깃헙액션에서 테스트컨테이너를 실행할때 사용하는 설정값입니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 management: endpoints: web: exposure: include: health,info endpoint: health: show-details: always server: port: 8080 spring: dataSource: url: jdbc:tc:mysql:8.0:///testdb driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver username: test password: test jpa: hibernate: ddl-auto: update show-sql: true database-platform: org.hibername.dialect.MySQL8Dialect logging: level: root: DEBUG deploy-openapi-swaggerhub.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 name: Deploy OpenAPI Spec to SwaggerHub on: push: branches: [\"main\", \"step05\", \"step06\"] jobs: deploy-openapi: runs-on: ubuntu-latest env: OWNER: sampleswagger-f17 API_NAME: hh-08-concert VERSION: 1.0.0 JAVA_TOOL_OPTIONS: \"-Dorg.slf4j.simpleLogger.defaultLogLevel=debug\" steps: - name: Checkout uses: actions/checkout@v3 # Java 설치 - name: Set up java uses: actions/setup-java@v3 with: java-version: \"17\" distribution: \"temurin\" - name: Give execute permission to gradlew run: chmod +x ./gradlew # application 빌드 - name: Build the application run: ./gradlew bootJar # application 백그라운드에서 실행 - name: Run the application in background run: | java -jar build/libs/concert-0.0.1-SNAPSHOT.jar --spring.profiles.active=ci \u0026 echo $! \u003e pid.txt # TestContainer 로그 확인 추가 - name: Debug logs if server fails if: failure() run: | echo \"🧩 Showing last 100 lines from app logs (if any)\" tail -n 100 build/libs/*.log || echo \"No log file\" echo \"🐳 Running Docker containers\" docker ps -a || echo \"Docker info not available\" # 서버가 통신되는지 확인 - name: Wait for server to be ready run: | for i in {1..30}; do curl --silent http://localhost:8080/actuator/health \u0026\u0026 exit 0 echo \"⏳ Waiting for server ...\" sleep 2 done echo \"❌ Server did not start in time\" echo \"📜 ==== APP LOG START ====\" cat app.log || echo \"No log file found\" echo \"📜 ==== APP LOG END ====\" cat pid.txt | xargs kill exit 1 # 로컬호스트내 OpenAPI 스펙다운로드 - name: Download OpenAPI spec run: curl http://localhost:8080/v3/api-docs -o openapi.json - name: Install SwaggerHub CLI run: npm install -g swaggerhub-cli - name: Push to swaggerHub run: | swaggerhub api:push $OWNER/$API_NAME/$VERSION \\ --file openapi.json \\ --token ${{ secrets.SWAGGERHUB_API_KEY }} \\ --visibility public 하지만 아쉽게도 Wait for server to be ready 단계에서 계속 똑같은 실패에서 발생을합니다. 연결이 되지 않았기 때문인데요. ( 이 문제에 대한 자세한 솔루션을 찾은경우에는 dmsrkd1216@gmail.com 으로 이메일 보내주시면 감사하겠습니다! )\n지금 과제를 해야되는데 과제와 상관없는 삽질을 해버리고말았네요 ㅠㅠ 시간이 많이 소요된 관계로 실패로 끝났습니다. 약 3시간 39분정도 시도를 해봤습니다. 결과를 못이뤄낸건 아쉽지만 그래도 후회는 없습니다.\n일단은 불편하더라도 직접 제가 복붙해서 사용하는 방안으로 진행해야될거같습니다. 아무래도 테스트컨테이너가 잘 지원한다해도 워크플로우에서의 서버와의 통신이 어려울거같습니다.\n만일 성공이 됐다하더라도, 추후에 레디스나, kafka 이 추가된다면 이 워크플로우에도 연결을 해서 반영을 해야될겁니다. TestContainers처럼 워크플로우 실행중에서만 사용되는 소프트웨어가 있는지 직접 찾아봐야될거 같습니다.\n참고: 협업을 위한 Swagger 배포하기(1) ","wordCount":"1245","inLanguage":"en","datePublished":"2025-04-04T00:00:00Z","dateModified":"2025-04-04T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://loveAlakazam.github.io/blog/docs/swagger-api/"},"publisher":{"@type":"Organization","name":"EK Dev Blog","logo":{"@type":"ImageObject","url":"https://loveAlakazam.github.io/blog/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://loveAlakazam.github.io/blog/ accesskey=h title="EK Dev Blog (Alt + H)"><img src=https://loveAlakazam.github.io/apple-touch-icon.png alt aria-label=logo height=35>EK Dev Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://eunkangchoi.github.io/resume/ title=Resume><span>Resume</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://loveAlakazam.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://loveAlakazam.github.io/blog/docs/>Docs</a></div><h1 class="post-title entry-hint-parent">SpringBoot에서 Swagger 도입부터 트러블슈팅에 배포까지...(?)</h1><div class=post-meta><span title='2025-04-04 00:00:00 +0000 UTC'>April 4, 2025</span></div></header><div class=post-content><h2 id=서론>서론<a hidden class=anchor aria-hidden=true href=#서론>#</a></h2><p>API명세서는 프론트엔드와 백엔드간의 협업을 위해서 가장 필요한 도구입니다.
백엔드 개발자는 API를 설계하고 공유할때 API명세서를 만듭니다. API 명세서를 다루는 대표적인 툴로는 Swagger가 있습니다.
이번에는 Swagger 을 도입하는 과정과 중간에 겪은 트러블슈팅 해결과정 그리고 더나아가서 직접 github-action으로 배포하는 과정을 공유해보도록하겠습니다.</p><hr><h2 id=스프링부트에-스웨거-도입하기>스프링부트에 스웨거 도입하기<a hidden class=anchor aria-hidden=true href=#스프링부트에-스웨거-도입하기>#</a></h2><ul><li>Java: 17</li><li>SpringBoot: 3.4.4</li></ul><h3 id=buildgradle-에-추가하기>build.gradle 에 추가하기<a hidden class=anchor aria-hidden=true href=#buildgradle-에-추가하기>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=c1>// Swagger UI
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=n>implementation</span> <span class=s1>&#39;org.springdoc:springdoc-openapi-starter-webmvc-ui:2.0.2&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>...</span><span class=err>생략</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=applicationyaml-에-추가하기>application.yaml 에 추가하기<a hidden class=anchor aria-hidden=true href=#applicationyaml-에-추가하기>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>spring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>application</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>hhplus-concert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>...(생략)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>springdoc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>api-docs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/v3/api-docs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>swagger-ui</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/swagger-ui.html</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>operationSorter</span><span class=p>:</span><span class=w> </span><span class=l>method</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><hr><h2 id=도입중-문제-발생>도입중 문제 발생<a hidden class=anchor aria-hidden=true href=#도입중-문제-발생>#</a></h2><p>로컬호스트에서 실행후, 브라우저의 URL에 <code>localhost:8080/swagger-ui/index.html</code> 에 접속했더니 아래이미지와 같은 에러가 발생했습니다.</p><p><img alt=swagger-error loading=lazy src=../images/swagger-error.png></p><p>이 에러에 대한 문제점 원인은 GlobalHandlerException 핸들러의 <code>@RestControllerAdvice</code> 데코레이터를 붙였기 때문에 발생했습니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// GlobalExceptionHandler.java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RestControllerAdvice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>GlobalExceptionHandler</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=c1>// 유효성검사 실패로 발생한 예외처리: 400 에러반환</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nd>@ExceptionHandler</span><span class=p>(</span><span class=n>InvalidValidationException</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nd>@ResponseStatus</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>BAD_REQUEST</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=kd>public</span><span class=w> </span><span class=n>ErrorResponse</span><span class=w> </span><span class=nf>handleInvalidValidationException</span><span class=p>(</span><span class=n>InvalidValidationException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>ErrorResponse</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>BAD_REQUEST</span><span class=p>.</span><span class=na>value</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=c1>// 서버내부 오류로 발생한 예외처리: 500 에러반환</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nd>@ExceptionHandler</span><span class=p>(</span><span class=n>Exception</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nd>@ResponseStatus</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=kd>public</span><span class=w> </span><span class=n>ErrorResponse</span><span class=w> </span><span class=nf>handleException</span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>ErrorResponse</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>INTERNAL_SERVER_ERROR</span><span class=p>.</span><span class=na>value</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>실행로그에서 발생한 오류문구는 아래와 같이 기재되어있습니다.
이 에러에 대한 해석을 해보자면, &ldquo;현재 실행중인 코드가 ControllerAdviceBean(Object) 라는 생성자 메서드가 있는줄 알았는데 실제로는 그 메서드가 없는 Spring 라이브러리를 참조하고 있어서 발생하는 오류이기 때문입니다.</p><blockquote><p>java.lang.NoSuchMethodError:
&lsquo;void org.springframework.web.method.ControllerAdviceBean.(java.lang.Object)&rsquo;</p></blockquote><p>Swagger UI는 내부적으로 <code>[GET] /v3/api-docs</code> URL을 호출하는데 이 요청을 처리하는 과정에서 <code>@ControllerAdvice</code>를 스캔하거나 초기화할때 오류가 발생하여 서버 자체에서 500에러를 리턴하여 스웨거문서 로딩에 실패됩니다.</p><p>GlobalExceptionHandler에 부여된 <code>@RestControllerAdvice</code> 데코레이터를 제거함으로써 이 문제를 해결했습니다.</p><ul><li>참고: <a href=https://dev-meung.tistory.com/entry/%ED%95%B4%EC%BB%A4%ED%86%A4-HY-THON-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-Swagger-500-%EC%97%90%EB%9F%AC-Failed-to-load-API-definition>[트러블슈팅] Swagger 500에러: Failed to load API definition</a></li></ul><hr><h2 id=로컬호스트에-있는-swagger-api명세를-swaggerhub에-옮길-수-없을까>로컬호스트에 있는 swagger API명세를 swaggerHub에 옮길 수 없을까?<a hidden class=anchor aria-hidden=true href=#로컬호스트에-있는-swagger-api명세를-swaggerhub에-옮길-수-없을까>#</a></h2><h3 id=1-로컬호스트의-swaggerlocalhost8080swagger-uiindexhtml에-접속하기>1. 로컬호스트의 swagger(<code>localhost:8080/swagger-ui/index.html</code>)에 접속하기<a hidden class=anchor aria-hidden=true href=#1-로컬호스트의-swaggerlocalhost8080swagger-uiindexhtml에-접속하기>#</a></h3><p><img alt=swagger-local loading=lazy src=../images/swagger-local.png></p><h3 id=2-v3api-docs에-접속해서-json코드를-얻기>2. <code>/v3/api-docs</code>에 접속해서 json코드를 얻기<a hidden class=anchor aria-hidden=true href=#2-v3api-docs에-접속해서-json코드를-얻기>#</a></h3><p>위의 이미지처럼 작은 글씨로 <code>/v3/api-docs</code> 링크에 들어가게되면 로컬에 띄운 swaggerUI에 대한 JSON 파일을 얻을 수 있습니다. 참고로 pretty 포맷팅보다는 raw 포맷팅으로 json파일을 복사하기를 권장합니다.</p><p><img alt=swagger-ui-to-json loading=lazy src=../images/swagger-ui-to-json.png></p><h3 id=3-코드-포맷-변경-사이트에-들어가서-json-복붙하여-yaml-로-코드를-변환하기>3. 코드 포맷 변경 사이트에 들어가서 json 복붙하여 yaml 로 코드를 변환하기<a hidden class=anchor aria-hidden=true href=#3-코드-포맷-변경-사이트에-들어가서-json-복붙하여-yaml-로-코드를-변환하기>#</a></h3><ul><li>코드 포맷 변경 사이트: <a href=https://www.bairesdev.com/tools/json2yaml/>BairesDev</a></li></ul><h3 id=4-만들어둔-swaggerhub-프로젝트에-복붙후-이상없으면-저장하기>4. 만들어둔 SwaggerHub 프로젝트에 복붙후 이상없으면 저장하기<a hidden class=anchor aria-hidden=true href=#4-만들어둔-swaggerhub-프로젝트에-복붙후-이상없으면-저장하기>#</a></h3><p>SwaggerHub 프로젝트는 SmartBear의 SwaggerHub에 회원가입 후에 프로젝트를 만들 수 있습니다. 신규계정은 30일동안 유료티어 기능을 사용할 수 있어요~!</p><p><img alt=swaggerhub-api-hub loading=lazy src=../images/swaggerhub-api-hub.png></p><ul><li>참고: <a href=https://velog.io/@gdhi/GitHub%EC%97%90-Swagger-API-%EB%AC%B8%EC%84%9C%EB%A5%BC-%EA%B3%B5%EC%9C%A0%ED%95%98%EA%B8%B0>Github에 Swagger API 문서를 공유하기</a></li></ul><hr><h2 id=github-action을-이용해서-swagger-서버를-배포해보자>github-action을 이용해서 swagger 서버를 배포해보자<a hidden class=anchor aria-hidden=true href=#github-action을-이용해서-swagger-서버를-배포해보자>#</a></h2><p>직접 localhost에 있는 스웨거 json코드를 yaml로 변환해서 swaggerHub에 직접 복붙하는 방식은 손이 많이 가기때문에 귀찮고 불편했습니다. API 응답결과나 응답상태값이 추가되거나 변경될 수 있을텐데 유지보수 측면에서는 비효율을 해결하고 싶었습니다.</p><p>여러가지 방법들이 존재 했습니다. github-action이 가장쉬운방법이긴한데.. 아쉽게도 github-pages를 이용한 방법을하려면 깃헙계정 1개당 1개의 페이지를 만들 수 있는 제약이 있습니다. 저의 경우에는 이 블로그가 github-page를 이용한 방법이기때문에 다른 방법을 찾아봐야했습니다. 고민하던중 깃헙액션의 워크플로우로 작성하는 방법으로 진행해보기로했습니다.</p><h3 id=워크플로우-파일-작성-1차>워크플로우 파일 작성 (1차)<a hidden class=anchor aria-hidden=true href=#워크플로우-파일-작성-1차>#</a></h3><blockquote><p>deploy-openapi-swaggerhub.yaml</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33>33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34>34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35>35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36>36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37>37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38>38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39>39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40>40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41>41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42>42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43>43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44>44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45>45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46>46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47>47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48>48</a>
</span><span class=lnt id=hl-3-49><a class=lnlinks href=#hl-3-49>49</a>
</span><span class=lnt id=hl-3-50><a class=lnlinks href=#hl-3-50>50</a>
</span><span class=lnt id=hl-3-51><a class=lnlinks href=#hl-3-51>51</a>
</span><span class=lnt id=hl-3-52><a class=lnlinks href=#hl-3-52>52</a>
</span><span class=lnt id=hl-3-53><a class=lnlinks href=#hl-3-53>53</a>
</span><span class=lnt id=hl-3-54><a class=lnlinks href=#hl-3-54>54</a>
</span><span class=lnt id=hl-3-55><a class=lnlinks href=#hl-3-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy OpenAPI Spec to SwaggerHub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;main&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy-openapi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>OWNER</span><span class=p>:</span><span class=w> </span><span class=l>sampleswagger-f17</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>API_NAME</span><span class=p>:</span><span class=w> </span><span class=l>hh-08-concert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VERSION</span><span class=p>:</span><span class=w> </span><span class=m>1.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Give execute permission to gradlew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chmod +x ./gradlew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># application 빌드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build the application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>./gradlew bootJar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># application 백그라운드에서 실행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run the application in background</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          java -jar build/libs/concert-0.0.1-SNAPSHOT.jar &amp;
</span></span></span><span class=line><span class=cl><span class=sd>          echo $! &gt; pid.txt</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 스프링부트가 완전히 올라올때까지 대기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># http://localhost:8080/actuator/health 는 health-check이며</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 서버가 잘 동작하는지 확인할 수 있습니다.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Wait for server to be ready</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          for i in {1..30}; do
</span></span></span><span class=line><span class=cl><span class=sd>            curl --silent http://localhost:8080/actuator/health &amp;&amp; exit 0
</span></span></span><span class=line><span class=cl><span class=sd>            echo &#34;⏳ Waiting for server ...&#34;
</span></span></span><span class=line><span class=cl><span class=sd>            sleep 2
</span></span></span><span class=line><span class=cl><span class=sd>          done
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;❌ Server did not start in time&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          cat pid.txt | xargs kill
</span></span></span><span class=line><span class=cl><span class=sd>          exit 1</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 로컬호스트내 OpenAPI 스펙다운로드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Download OpenAPI spec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>curl http://localhost:8080/v3/api-docs -o openapi.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install SwaggerHub CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>npm install -g swaggerhub-cli</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Push to swaggerHub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          swaggerhub api:push &lt;OWNER&gt;/&lt;API_NAME&gt;/&lt;VERSION&gt; \
</span></span></span><span class=line><span class=cl><span class=sd>            --file openapi.json \
</span></span></span><span class=line><span class=cl><span class=sd>            --token ${{ secrets.SWAGGERHUB_API_KEY }} \
</span></span></span><span class=line><span class=cl><span class=sd>            --visibility public</span><span class=w>          
</span></span></span></code></pre></td></tr></table></div></div><h3 id=swaggerhub의-정보-파악하기>swaggerHub의 정보 파악하기<a hidden class=anchor aria-hidden=true href=#swaggerhub의-정보-파악하기>#</a></h3><p>스웨거헙은 OWNER / API_NAME / VERSION 으로 구성되어있습니다.
아래의 이미지의 URL을 확인해보시면 쉽게 이해할 수 있습니다.</p><p><img alt=swaggerhub-info loading=lazy src=../images/swaggerhub-info.png></p><h3 id=스웨거-api키-발급과-깃헙시크릿키-값에-넣기>스웨거 API키 발급과 깃헙시크릿키 값에 넣기<a hidden class=anchor aria-hidden=true href=#스웨거-api키-발급과-깃헙시크릿키-값에-넣기>#</a></h3><ol><li><p>swaggerHub의 API 시크릿키 찾기</p><p><img alt=swaggerhub-secret-1 loading=lazy src=../images/swaggerhub-secret-1.png>
<img alt=swaggerhub-secret-2 loading=lazy src=../images/swaggerhub-secret-2.png></p></li><li><p>swaggerHub API 시크릿값을 Github 래포지토리 시크릿값에 넣기</p><p><img alt=swaggerhub-secret-3 loading=lazy src=../images/swaggerhub-secret-3.png>
<img alt=swaggerhub-secret-4 loading=lazy src=../images/swaggerhub-secret-4.png></p></li></ol><h3 id=반복되는-빌드-실패>반복되는 빌드 실패&mldr;<a hidden class=anchor aria-hidden=true href=#반복되는-빌드-실패>#</a></h3><p><img alt=fail-workflow-build loading=lazy src=../images/fail-workflow-build.png></p><p>결국은 워크플로우를 했지만 실패가 나왔습니다. 그에대한 이유는 아무래도 스프링부트를 실행하려면 데이터베이스와의 연결이 필요하기 때문입니다. 이 프로세스가 되려면 원격으로 데이터베이스가 필요합니다. 하지만 스웨거만을 배포해야되므로 굳이 클라우드의 DB를 붙일 필요가 없으므로 TestContainers를 하기로 했습니다.</p><h2 id=testcontainer-설정하기>TestContainer 설정하기<a hidden class=anchor aria-hidden=true href=#testcontainer-설정하기>#</a></h2><p>이 프로젝트에서는 Mysql을 사용하기 때문에 TestContainer도 동일한 데이터베이스를 사용해야합니다. build.gradle에 TestContainer 관련해서 추가해야합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=c1>// build.gradle
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>testImplementation</span> <span class=s1>&#39;org.testcontainers:junit-jupiter&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>testImplementation</span> <span class=s1>&#39;org.testcontainers:mysql&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=워크플로우파일-작성-2차>워크플로우파일 작성 (2차)<a hidden class=anchor aria-hidden=true href=#워크플로우파일-작성-2차>#</a></h3><blockquote><p>application-ci.yml</p></blockquote><p>깃헙액션에서 테스트컨테이너를 실행할때 사용하는 설정값입니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>management</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>web</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exposure</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>health,info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>endpoint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>health</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>show-details</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>server</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dataSource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>jdbc:tc:mysql:8.0:///testdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>driver-class-name</span><span class=p>:</span><span class=w> </span><span class=l>org.testcontainers.jdbc.ContainerDatabaseDriver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jpa</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hibernate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ddl-auto</span><span class=p>:</span><span class=w> </span><span class=l>update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>show-sql</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>database-platform</span><span class=p>:</span><span class=w> </span><span class=l>org.hibername.dialect.MySQL8Dialect</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>level</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>root</span><span class=p>:</span><span class=w> </span><span class=l>DEBUG</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>deploy-openapi-swaggerhub.yaml</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44>44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45>45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46>46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47>47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48>48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49>49</a>
</span><span class=lnt id=hl-6-50><a class=lnlinks href=#hl-6-50>50</a>
</span><span class=lnt id=hl-6-51><a class=lnlinks href=#hl-6-51>51</a>
</span><span class=lnt id=hl-6-52><a class=lnlinks href=#hl-6-52>52</a>
</span><span class=lnt id=hl-6-53><a class=lnlinks href=#hl-6-53>53</a>
</span><span class=lnt id=hl-6-54><a class=lnlinks href=#hl-6-54>54</a>
</span><span class=lnt id=hl-6-55><a class=lnlinks href=#hl-6-55>55</a>
</span><span class=lnt id=hl-6-56><a class=lnlinks href=#hl-6-56>56</a>
</span><span class=lnt id=hl-6-57><a class=lnlinks href=#hl-6-57>57</a>
</span><span class=lnt id=hl-6-58><a class=lnlinks href=#hl-6-58>58</a>
</span><span class=lnt id=hl-6-59><a class=lnlinks href=#hl-6-59>59</a>
</span><span class=lnt id=hl-6-60><a class=lnlinks href=#hl-6-60>60</a>
</span><span class=lnt id=hl-6-61><a class=lnlinks href=#hl-6-61>61</a>
</span><span class=lnt id=hl-6-62><a class=lnlinks href=#hl-6-62>62</a>
</span><span class=lnt id=hl-6-63><a class=lnlinks href=#hl-6-63>63</a>
</span><span class=lnt id=hl-6-64><a class=lnlinks href=#hl-6-64>64</a>
</span><span class=lnt id=hl-6-65><a class=lnlinks href=#hl-6-65>65</a>
</span><span class=lnt id=hl-6-66><a class=lnlinks href=#hl-6-66>66</a>
</span><span class=lnt id=hl-6-67><a class=lnlinks href=#hl-6-67>67</a>
</span><span class=lnt id=hl-6-68><a class=lnlinks href=#hl-6-68>68</a>
</span><span class=lnt id=hl-6-69><a class=lnlinks href=#hl-6-69>69</a>
</span><span class=lnt id=hl-6-70><a class=lnlinks href=#hl-6-70>70</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy OpenAPI Spec to SwaggerHub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;main&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;step05&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;step06&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy-openapi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>OWNER</span><span class=p>:</span><span class=w> </span><span class=l>sampleswagger-f17</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>API_NAME</span><span class=p>:</span><span class=w> </span><span class=l>hh-08-concert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VERSION</span><span class=p>:</span><span class=w> </span><span class=m>1.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>JAVA_TOOL_OPTIONS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;-Dorg.slf4j.simpleLogger.defaultLogLevel=debug&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Java 설치</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up java</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-java@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>java-version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;17&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>distribution</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;temurin&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Give execute permission to gradlew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chmod +x ./gradlew</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># application 빌드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build the application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>./gradlew bootJar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># application 백그라운드에서 실행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run the application in background</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          java -jar build/libs/concert-0.0.1-SNAPSHOT.jar --spring.profiles.active=ci &amp;
</span></span></span><span class=line><span class=cl><span class=sd>          echo $! &gt; pid.txt</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># TestContainer 로그 확인 추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Debug logs if server fails</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>failure()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;🧩 Showing last 100 lines from app logs (if any)&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          tail -n 100 build/libs/*.log || echo &#34;No log file&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;🐳 Running Docker containers&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          docker ps -a || echo &#34;Docker info not available&#34;</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 서버가 통신되는지 확인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Wait for server to be ready</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          for i in {1..30}; do
</span></span></span><span class=line><span class=cl><span class=sd>            curl --silent http://localhost:8080/actuator/health &amp;&amp; exit 0
</span></span></span><span class=line><span class=cl><span class=sd>            echo &#34;⏳ Waiting for server ...&#34;
</span></span></span><span class=line><span class=cl><span class=sd>            sleep 2
</span></span></span><span class=line><span class=cl><span class=sd>          done
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;❌ Server did not start in time&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;📜 ==== APP LOG START ====&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          cat app.log || echo &#34;No log file found&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;📜 ==== APP LOG END ====&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          cat pid.txt | xargs kill
</span></span></span><span class=line><span class=cl><span class=sd>          exit 1</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 로컬호스트내 OpenAPI 스펙다운로드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Download OpenAPI spec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>curl http://localhost:8080/v3/api-docs -o openapi.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install SwaggerHub CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>npm install -g swaggerhub-cli</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Push to swaggerHub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          swaggerhub api:push $OWNER/$API_NAME/$VERSION \
</span></span></span><span class=line><span class=cl><span class=sd>            --file openapi.json \
</span></span></span><span class=line><span class=cl><span class=sd>            --token ${{ secrets.SWAGGERHUB_API_KEY }} \
</span></span></span><span class=line><span class=cl><span class=sd>            --visibility public</span><span class=w>          
</span></span></span></code></pre></td></tr></table></div></div><p>하지만 아쉽게도 <code>Wait for server to be ready</code> 단계에서 계속 똑같은 실패에서 발생을합니다. 연결이 되지 않았기 때문인데요. ( 이 문제에 대한 자세한 솔루션을 찾은경우에는 <a href=mailto:dmsrkd1216@gmail.com>dmsrkd1216@gmail.com</a> 으로 이메일 보내주시면 감사하겠습니다! )</p><p>지금 과제를 해야되는데 과제와 상관없는 삽질을 해버리고말았네요 ㅠㅠ 시간이 많이 소요된 관계로 실패로 끝났습니다. 약 3시간 39분정도 시도를 해봤습니다. 결과를 못이뤄낸건 아쉽지만 그래도 후회는 없습니다.</p><p>일단은 불편하더라도 직접 제가 복붙해서 사용하는 방안으로 진행해야될거같습니다.
아무래도 테스트컨테이너가 잘 지원한다해도 워크플로우에서의 서버와의 통신이 어려울거같습니다.</p><p>만일 성공이 됐다하더라도, 추후에 레디스나, kafka 이 추가된다면 이 워크플로우에도 연결을 해서 반영을 해야될겁니다. TestContainers처럼 워크플로우 실행중에서만 사용되는 소프트웨어가 있는지 직접 찾아봐야될거 같습니다.</p><ul><li>참고: <a href=https://jihyun-devstory.tistory.com/41>협업을 위한 Swagger 배포하기(1)</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://loveAlakazam.github.io/blog/docs/hh-08-week02-remind/><span class=title>« Prev</span><br><span>항해99 2주차 회고 (WIL)</span>
</a><a class=next href=https://loveAlakazam.github.io/blog/docs/hh-08-week01-remind/><span class=title>Next »</span><br><span>항해99 1주차 회고 (WIL)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://loveAlakazam.github.io/blog/>EK Dev Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>